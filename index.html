<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>è‹¹æœæ‰‹æœºè´­ä¹°ç»Ÿè®¡</title>

<style>
body{
  font-family: system-ui;
  background:#f5f5f7;
}
.app{
  max-width:540px;
  margin:auto;
  background:#fff;
  padding:16px;
  border-radius:16px;
}
.item{
  display:flex;
  align-items:center;
  margin-bottom:6px;
}
.item span{
  flex:1;
  font-size:14px;
}
.qty{
  width:60px;
  padding:4px;
  color:red;
  font-weight:bold;
}
.pm-btn{
  width:26px;
  height:26px;
  margin-left:4px;
  border:none;
  border-radius:6px;
  background:#e5e5ea;
  font-size:16px;
}
button.main{
  width:100%;
  margin-top:8px;
  padding:10px;
  border:none;
  border-radius:12px;
  background:#007aff;
  color:white;
  font-size:16px;
}
button.danger{background:#ff3b30;}
pre{
  background:#f0f0f0;
  padding:10px;
  border-radius:12px;
  font-size:13px;
  white-space:pre-wrap;
}
table{
  width:100%;
  border-collapse:collapse;
  font-size:13px;
}
th,td{
  border-bottom:1px solid #ddd;
  padding:6px;
  text-align:center;
}
.action{color:#007aff;cursor:pointer;}
.delete{color:#ff3b30;margin-left:6px;}
.red{color:red;font-weight:bold;}
</style>
</head>

<body>
<div class="app">

<h2>ğŸ“± è‹¹æœæ‰‹æœºè´­ä¹°ç»Ÿè®¡</h2>

<div id="list"></div>

<input id="remark" placeholder="å¤‡æ³¨ï¼ˆå®¢æˆ· / æ‰¹æ¬¡ç­‰ï¼‰"
 style="width:100%;padding:8px;margin:8px 0;">

<button class="main" onclick="save()">ç»Ÿè®¡å¹¶ä¿å­˜</button>
<button class="main" onclick="copyResult()">å¤åˆ¶ç»Ÿè®¡ç»“æœ</button>
<button class="main danger" onclick="clearAll()">æ¸…ç©ºå†å²</button>

<h3>ğŸ“„ æœ¬æ¬¡ç»Ÿè®¡</h3>
<pre id="result"></pre>

<h3>ğŸ•’ å†å²è®°å½•</h3>
<table>
<thead>
<tr>
  <th>æ—¶é—´</th>
  <th>å¤‡æ³¨</th>
  <th>æ€»è®¡</th>
  <th>æ“ä½œ</th>
</tr>
</thead>
<tbody id="history"></tbody>
</table>

</div>

<script>
/* ===== å‹å·é…ç½®ï¼ˆæ ¼å¼ä¸åŠ¨ï¼‰ ===== */
const items = [
["Max 256 silver","Max"],["Max256blue","Max"],["Max256orange","Max"],
["Max 512 silver","Max"],["Max 512 blue","Max"],["Max 512 orange","Max"],
["Max 1TB silver","Max"],["Max 1TB orange","Max"],["Max 1TB blue","Max"],
["Pro 256 silver","Pro"],["Pro256blue","Pro"],["Pro256orange","Pro"],
["Pro 512 silver","Pro"],["Pro 512 orange","Pro"],["Pro 512 blue","Pro"],
["17 256white","17"],["17 256black","17"],["17 256 blue","17"],
["17 256 lavender","17"],["17 256 sage","17"]
];

const listEl   = document.getElementById("list");
const historyEl= document.getElementById("history");
const resultEl = document.getElementById("result");
const remarkEl = document.getElementById("remark");

let history = JSON.parse(localStorage.getItem("appleHistory") || "[]");

/* ===== æ¸²æŸ“è¾“å…¥åˆ—è¡¨ ===== */
function renderList(data = {}){
  let html="";
  items.forEach(([label])=>{
    const v = data[label] ?? "";
    html += `
<div class="item">
  <span>${label} Ã—</span>
  <input class="qty" data-l="${label}" value="${v}">
  <button class="pm-btn" onclick="change('${label}',1)">ï¼‹</button>
  <button class="pm-btn" onclick="change('${label}',-1)">ï¼</button>
</div>`;
  });
  listEl.innerHTML = html;
}

function change(label,n){
  const el = document.querySelector(`.qty[data-l="${label}"]`);
  el.value = (Number(el.value) || 0) + n;
}

/* ===== ä¿å­˜ ===== */
function save(){
  let sum={Max:0,Pro:0,"17":0};
  let total=0;
  let text="";
  let data={};

  items.forEach(([label,group])=>{
    const v = Number(
      document.querySelector(`.qty[data-l="${label}"]`).value || 0
    );
    data[label]=v;
    sum[group]+=v;
    total+=v;
    text += `${label} Ã—${v || ""}\n`;
  });

  text +=
`â€”â€”â€”
Max åˆè®¡ï¼š${sum.Max}
Pro åˆè®¡ï¼š${sum.Pro}
17 åˆè®¡ï¼š${sum["17"]}
æ€»è®¡ï¼š${total}`;

  history.unshift({
    time:new Date().toLocaleString(),
    remark:remarkEl.value||"-",
    total,
    text,
    data
  });

  localStorage.setItem("appleHistory",JSON.stringify(history));
  resultEl.innerText=text;
  remarkEl.value="";
  renderHistory();
}

/* ===== å¤åˆ¶ ===== */
function copyResult(){
  if(!resultEl.innerText) return alert("æ²¡æœ‰ç»“æœ");
  navigator.clipboard.writeText(resultEl.innerText)
    .then(()=>alert("å·²å¤åˆ¶"));
}

/* ===== å†å² ===== */
function renderHistory(){
  historyEl.innerHTML="";
  history.forEach((r,i)=>{
    historyEl.innerHTML+=`
<tr>
<td>${r.time}</td>
<td>${r.remark}</td>
<td class="red">${r.total}</td>
<td>
<span class="action" onclick="load(${i})">è½½å…¥</span>
<span class="action delete" onclick="del(${i})">åˆ é™¤</span>
</td>
</tr>`;
  });
}

function load(i){
  renderList(history[i].data);
  resultEl.innerText = history[i].text;
}

function del(i){
  if(confirm("ç¡®å®šåˆ é™¤ï¼Ÿ")){
    history.splice(i,1);
    localStorage.setItem("appleHistory",JSON.stringify(history));
    renderHistory();
    resultEl.innerText="";
  }
}

function clearAll(){
  if(confirm("ç¡®å®šæ¸…ç©ºå…¨éƒ¨å†å²ï¼Ÿ")){
    history=[];
    localStorage.removeItem("appleHistory");
    renderHistory();
    resultEl.innerText="";
    renderList();
  }
}

/* ===== åˆå§‹åŒ– ===== */
renderList();
renderHistory();
</script>
</body>
</html>
